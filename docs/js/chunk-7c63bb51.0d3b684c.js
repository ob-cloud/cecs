(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7c63bb51"],{a236:function(e,t,n){"use strict";var a=n("ecc0"),o=n.n(a);o.a},d4fe:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"device smart"},[n("base-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],attrs:{height:e.tableHeight,tableData:e.tableData,columns:e.columns,stripe:"",border:"",pageTotal:e.total,pageSize:e.search.pageSize},on:{"on-current-page-change":e.onCurrentChange,"on-page-size-change":e.onSizeChange}},[e._t("default",[n("template",{slot:"caption"},[n("el-select",{staticClass:"caption-item",attrs:{clearable:"",placeholder:"所有场景"},model:{value:e.search.scene_number,callback:function(t){e.$set(e.search,"scene_number",t)},expression:"search.scene_number"}},[n("el-option",{attrs:{label:"所有场景",value:""}})],1),n("el-input",{staticClass:"caption-item",attrs:{placeholder:"场景名称"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSearch(t)}},model:{value:e.search.scene_name,callback:function(t){e.$set(e.search,"scene_name",t)},expression:"search.scene_name"}}),n("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleSearch}},[e._v("查询")])],1),n("template",{slot:"actionBar"},[n("el-dropdown",{attrs:{trigger:"click"},on:{command:e.handleSceneCommand}},[n("el-button",{attrs:{type:"primary"}},[e._v("\n            创建"),n("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",{attrs:{command:"local"}},[e._v("本地场景")]),n("el-dropdown-item",{attrs:{command:"remote"}},[e._v("云端场景")])],1)],1)],1)])],2)],1)},o=[],c=(n("386d"),n("29d7")),r=(n("8e6e"),n("ac6a"),n("456d"),n("bd86")),i=n("cb4b");function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(n,!0).forEach(function(t){Object(r["a"])(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var u={getSceneList:function(e){var t=e.pageNo,n=e.pageSize;return delete e.pageNo,delete e.pageSize,i["a"].get("/consumer/common",l({CMD:"query_scenes",start:t,count:n},e))},removeScene:function(e,t){return i["a"].get("/consumer/common",{CMD:"execute_sc",scene_status:e,scene_number:t})}},h=u,d=n("9a36"),g=n("0feb"),m={data:function(){return{tableLoading:!0,tableHeight:0,search:{scene_number:"",scene_name:"",pageNo:d["a"],pageSize:d["b"]},tableData:[],columns:[]}},components:{BaseTable:c["a"]},created:function(){this.columns=this.getColumns(),this.getSceneList()},computed:{total:function(){return this.tableData.length||0}},mounted:function(){g["a"].windowOnResize(this,this.fixLayout)},methods:{fixLayout:function(){this.tableHeight=g["a"].calculateTableHeight()},getColumns:function(){this.$createElement;var e=this;return[{label:"场景序号",prop:"scene_number",align:"center"},{label:"场景名称",prop:"scene_name",align:"center"},{label:"场景类型",prop:"scene_type",align:"center",formatter:function(e){var t={"00":"服务器场景","01":"本地场景","02":"有人场景","03":"无人场景","04":"安防场景"};return t[e]||"服务器场景"}},{label:"消息推送",prop:"msg_alter",align:"center",formatter:function(e){var t={0:"无推送",1:"APP推送",2:"短信推送",3:"APP+短信推送"};return t[e]||"无推送"}},{label:"场景状态",align:"center",renderBody:function(t,n){return t("el-switch",{on:{change:function(){e.handleChangeStatus(n)}},attrs:{value:[!1,!0][n.scene_status],"active-color":"#409EFF","inactive-color":"#DCDFE6"}})}},{label:"操作",align:"center",minWidth:"180px",renderBody:this.getToolboxRender}]},getToolboxRender:function(e,t){var n=this;return[e("el-button",{attrs:{size:"tiny",icon:"el-icon-view",title:"执行场景"},on:{click:function(){return n.view(t)}}}),e("el-button",{attrs:{size:"tiny",icon:"el-icon-edit",title:"编辑"},on:{click:function(){return n.edit(t)}}}),e("el-button",{attrs:{size:"tiny",icon:"el-icon-delete",title:"删除"},on:{click:function(){return n.handleRemove(t)}}})]},getSceneList:function(){var e=this;this.tableLoading=!0,h.getSceneList(this.search).then(function(t){200===t.status?e.tableData=t.data.scenes:e.$message({message:t.message||"场景获取失败"}),e.tableLoading=!1}).catch(function(t){e.$message({title:"失败",message:t.message||"服务出错",type:"error"}),e.tableLoading=!1})},onCurrentChange:function(e){this.search.pageNo=e,this.getSceneList()},onSizeChange:function(e){this.search.pageSize=e,this.getSceneList()},handleSearch:function(){this.search.pageNo=d["a"],this.getSceneList()},handleChangeStatus:function(e){e.scene_status=1-e.scene_status},view:function(e){var t=this.$loading({lock:!0,text:"正在执行场景..."});setTimeout(function(){t.close()},1500)},edit:function(e){console.log("edit ",e)},handleRemove:function(e){this.$confirm("确认删除场景？","确认提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",closeOnClickModal:!1}).then(function(){}).catch(function(){console.log("取消删除")})},doRemove:function(e,t){h.removeScene(e,t).then(function(e){console.log(e)})},handleSceneCommand:function(e){"local"===e&&this.createLocalScene(),"remote"===e&&this.createRemoteScene()},createLocalScene:function(){console.log("本地场景 ")},createRemoteScene:function(){console.log("云端场景 ")}}},p=m,b=(n("a236"),n("2877")),f=Object(b["a"])(p,a,o,!1,null,"9b523ed4",null);t["default"]=f.exports},ecc0:function(e,t,n){}}]);
//# sourceMappingURL=chunk-7c63bb51.0d3b684c.js.map